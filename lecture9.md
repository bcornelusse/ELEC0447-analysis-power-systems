class: middle, center, title-slide
count: false

# Analysis of electric power and energy systems

<!--
 
python3 -m http.server 8001 &


decktape http://0.0.0.0:8001/?p=lecture8.md pdf/lecture8.pdf

http://0.0.0.0:8001/?p=lecture7.md#1
-->


Lecture 9: Control of interconnected power systems and economic dispatch

<br><br>

Louis Wehenkel<br>
[L.Wehenkel@uliege.be](mailto:L.Wehenkel@uliege.be)


---

# What will we learn today?

- Why do we need to control the voltage and frequency ?
- Control approaches of voltage and frequency in power systems
- Economic dispatch and optimal power flow methods
- Power systems security assessment

This lecture expands on Chapter 12 from the Ned Mohan's book.

---

class: middle

# Why and how to control voltage and frequency ?

- Technical requirements
 - Power system devices are designed so as to operate within well-defined
   'tolerance regions' around nominal values $V_n$ and $f_n$
 - Large/persistent deviations from
 nominal values could lead to cascading phenomena, service interruptions, and safety problems

- Exogenous threats
 - Sudden disturbances, such as line or generator tripping
 - Fast variations of net load (cf Duck curve)
 
- Control resources
 - Adjusting synchronous generators' field current and mechanical
 power 
 - Changing transformer taps,
 or switching lines and/or shunt compensation 
 - Fast start-up of generator units and/or in extremis load curtailment


---

class: middle

# Principle of Automatic Voltage Control

- *The main tool:* primary voltage control via *Automatic Voltage
  Regulators (AVRs)* of large synchronous generators and synchronous condensers
- Secondary voltage control and automatic switching of reactive
compensation devices and transformer taps
- Tertiary voltage control and voltage profile optimization

---

## Automatic voltage regulator of a synchronous machine

.width-35[![](figureslw/exciter.png)] .width-60[![](figureslw/avr.png)]

##### Figure on the right from: Voltage stability of electric power systems. T. Van  Cutsem & C. Vournas, KAP 1998

- Notice that if several generators are connected in parallel (either
  at the MV or at the EHV bus), it is necessary to coordinate
  their AVRs so that they share the reactive power in an even way.

- The value of $Z_c$ may be adjusted in order to ensure such a coordination.

---

## Primary, secondary and tertiary voltage control

- When a disturbance occurs, or subsequently to following the change
  in load (cf. 'duck curve'), the *primary* voltage control loops
  maintain suitable voltage levels 
  close to the large power plants equipped with AVRs.

 - However voltages at other buses may move out of tolerance intervals
  (in either direction), and reactive power reserves may
  not be shared in an even way among generators.

- *Secondary* voltage control loops can be used at the zonal
 level, to adjust the set-points of AVRs
so as to control the voltage at 'pilot nodes' in the network while distributing
the required reactive power evenly among generators.

 - Secondary voltage control loops can also be used to
switch shunt reactive compensation devices (capacitors/inductors) in
 order to increase reactive power generation margins in their zone
 (among a few large power plants).

- *Tertiary* voltage control uses OPF solvers to calculate set-points
  at pilot nodes and possibly adjust some transformer ratios, so as to minimize losses
  and maximize MVar reserves at the entire system level.

- Response times of different levels of voltage control

 - *Primary:* 1-3 seconds ; *Secondary:* 30 seconds -3 minutes ; *Tertiary:* 10-15 minutes 

---

class: middle

# Principle of Automatic Frequency Control

- *The main tool:* primary frequency control via *speed governors* of large synchronous generators
- Secondary frequency control (aka *Automatic Generation Control  (AGC)*)
- Tertiary frequency control 

---

## Speed governor  of  a synchronous generator

.width-55[![](figureslw/governor.png)] .width-30[![](figureslw/droop-1gen.png)] 

- Measurement of rotor speed (or stator frequency as a proxy)
- If frequency (speed) is a bit below $f_0$, the governor opens a bit
more the valve to
increase the mechanical power $P_m$
- In steady state, speed  and mechanical power (or equivalently, frequency and electric
  power) are related by a linear
  relationship (see diagram on the right)
- This relationship allows to predict how the power generated by a
certain generator would change when frequency changes
- It also shows that in order to have the generator adapt his power
  via this primary control loop,
  the frequency must change


---

## The case of two generators helping out with a sudden increase of load

.width-90[![](figureslw/two-gen-primary.png)]

- Imagine that suddenly load power increases by $\Delta P_L$: because of KL, total electric power of generators will also
increase, hence they start to decelerate leading to a frequency drop. Both will react, according to the governor settings of their primary
frequency control loop, to increase their mechanical power
- At steady state, $\Delta f$ will be such that
$\Delta P_1+ \Delta P_2 = \Delta P_L$; typical time to reach steady state: 10-20s
- Depending on mechanical inertia and speed of governor controls, frequency 'nadir' can be much lower
  than final $f_0 + \Delta f$ at steady state.

---
## Primary frequency control in an interconnected system

- Goal: avoid too large frequency drop upon sudden loss of (the
largest) generator connected to the system
 - Each area contributes in proportion to its load level,
 - Within each area, some generators are recruited to ensure area
requirement,
 - There is a mutualisation of primary frequency control reserves.
 - If primary frequency control is unable to prevent a too large drop in frequency,
    more heroic emergency controls will act, e.g.
    under-frequency load shedding (see Movies)

.center[.width-60[![](figureslw/nadir.png)]]

##### Fig from: https://top10electrical.blogspot.com/2015/10/primary-secondary-and-tertiary.html




---

class: middle, center, black-slide

<iframe width="600" height="450" src="https://www.youtube.com/embed/Bfe0LaIUJ5g?list=PLXUccGn4ptEMJ6vVL6f5DOzQIEuAT941q" frameborder="0" allowfullscreen></iframe>

Automatic under frequency load shedding

---

## Secondary frequency control (aka AGC)

- After (gentle and successful) settlement of primary frequency
control there are however some
undesirable side effects:
 - Frequency has deviated from the nominal value
 - The exchanges between areas have deviated from their scheduled
 values
 - Part of the primary frequency control reserves have been depleted
- AGC (or secondary frequency control) aims at cancelling these side effects:

.width-70[![](figureslw/ace.png)]


 - Since AGC is an integral control, its steady state corresponds to
 zero $\Delta f$ and zero $\Delta P$ (tie-line flows are also steered
 back to scheduled values)
 - Once frequency is back to normal, primary control reserves are
   again fully available (takes 5-15 minutes)


---

## Primary, secondary and tertiary frequency control

- *First*, primary control stabilizes frequency and power balance
 - response within 0-30s, fully local and fully automatic
- *Second*, frequency and power exchanges are brought back to
nominal/contractual values, and primary control reserves are restored
 - response within 0.5-15 minutes, via area-control center (e.g. one
   country in Europe)
- *Third*, generation and exchange schedules are re-optimized, while
restoring secondary frequency control reserves
 - response within 10-60 minutes, e.g. via intraday power exchange
   markets 

.center[.width-95[![](figureslw/1-2-3-freq.png)]]

##### Fig from: https://top10electrical.blogspot.com/2015/10/primary-secondary-and-tertiary.html


---

class: middle

# Economic dispatch and optimal power flow 

---

# Two optimization problems

## Economic dispatch problem statement (ED)

- Given a total load $P_L$ to serve, and a set of candidate generators
  $i=1\ldots n$, with $P_i$ constrained to $\underline{P}_i \ldots \overline{P}_i$, and a cost function $C_i(P_i)$,
- Find optimal values $P_i$ suchthat $\sum_i^n C_i(P_i)$ is minimized
  - while ensuring $\sum_i^n P_i = P_L$ (+ a loss term, possibly).
- See 12.4.1 of ref. book for some intuition about the
solution to this problem


## Optimal power flow problem statement (OPF)

- As above, + network constraints
 - (given network topology, and electrical parameters of lines, cables,
transformers, and shunt devices, as well as current flow limits of
lines and transformers, and voltage tolerance intervals
at buses)

- Determine the $P_i$ suchthat $\sum_i^n C_i(P_i)$ is minimized
 - while
  modeling KLaws and enforcing the above network-wise limits


---

class: middle

# Assessing the security/reliability of an electric power system

- General idea of security assessment
- Standard *N-1*  static security assessment
- Voltage stability assessment
- Transient stability assessment

---

## General idea of security/reliability assessment

- General motivation:
 - Check the robustness of the system to a
  number of possible *contingencies*
 - NB: see examples of contingencies in subsequent slides

- Generic security assessment approach:
 - Given a list of contingencies and a steady-state *base-case* operating point of
   the system
 - Simulate the impact of each contingency if it is applied to the
 base case
 - For each simulation, check whether system response is acceptable
 - Summarize and display the results for all contingencies
 - If  *too many contingencies lead to unaccaptable response*, the
   base-case is *insecure*

- Remarks:
  - Such analyses can be carried out periodically, based on real-time
  measurements
 - They can also be applied in look-head mode, on a set of
 possible future system conditions
 - Such analyses are extensively carried ou by TSOs, and when the
   conclusion is negative, the TSO has to decide preventive/corrective counter-measures

---

## Standard *N-1*  static security assessment


- List of contingencies: all single-component outages
  - e.g. all single-line outages + all single-transformer outages
  - plus possibly all
    single-generator outages
- Procedure:
  - Run a power flow computation for the base case, and check
    pre-contingency limits
  - For each outage in the contigency list, run a power flow
    computation to determine post-contingency voltages and currents,
    and check post-contingency limits 
- Precise limit values can depend on the context of security assessment:
	- e.g. in real-time operation, line/transformer permanent thermal limits and steady state voltage
      magnitude tolerance intervals are checked both for pre- and post-contingency
- Remarks/orders of magnitude:
 - e.g. for a system like the Belgian EHV transmission system (ELIA)
 - 1000-2000 contingencies
 - 2000-4000 limits to check for each contingency
 - Need to summarize in graphical form the results to be useful for a
   human operator

---

## Voltage stability assessment  (./...)

- Goal is to measure how far the system is from the voltage
instability
- Distance: *Load power margin* i.e. how much load can be further
increased until reaching the tip of the *nose-curve*


.center[.width-80[![](figureslw/vsa12.png)]]

---

## Voltage stability assessment (../...)

- Goal is to measure how far the system is from the voltage
instability
- Distance: *Load power margin* i.e. how much load can be further
increased until reaching the tip of the *nose-curve*


.center[.width-90[![](figureslw/pfonc-sev.png)]]

---

## Voltage stability assessment (.../...)

.center[.width-100[![](figureslw/vsa12.png)]]

---

## Transient stability assessment

- List of contingencies:
 - various 3-phase short-circuit locations and
  clearing schemes
  - e.g. at the EHV bus of each large power plant; on the different important lines
  connecting some power plants to the rest of the system
- Distance to instability:
  - compute CCT for each
  disturbance
  - compare with actual protection delays of the different types of faults

- Remarks:
 - Very time consuming computations, hardly possible in real-time
 - Need 'approximations' to speed up computations
 - Need to also determine suitable preventive or corrective countermeasures for the most
   dangerous contingencies

---

## Transient stability limited systems

- Hydro-power dominated systems (e.g. Hydro-Qu√©bec)
- Longitudinal systems (e.g. Vietnam, Italy)

- Counter-measures: power flow limits; fast
  generation-tripping systems

.center[.width-100[![](figureslw/hq.png)]]

---

class: middle

# Likely impact of the energy transition

---

## A think tank

- Less synchronous generators in operation at the transmission level
  results in reduced inertia and deeper frequency nadir, leading to
  more stringent requirements for (primary)  frequency control 
- Duck curve leads to higher variability of flows and more changes in
  flow-directions, making voltage control more complex/difficult
- Tech opportunities are provided by fast progress in IT and power electronics, leading
  to a lot of research and development opportunities


---

# References

- Mohan, Ned. Electric power systems: a first course. John Wiley & Sons, 2012.


---

class: end-slide, center
count: false

The end.
